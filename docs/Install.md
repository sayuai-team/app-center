# App Center å®‰è£…éƒ¨ç½²æŒ‡å—

## æ¦‚è¿°

App Center æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„åº”ç”¨åˆ†å‘ç®¡ç†å¹³å°ï¼Œæ”¯æŒ iOS å’Œ Android åº”ç”¨çš„ä¸Šä¼ ã€ç®¡ç†å’Œåˆ†å‘ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨ä»é›¶å¼€å§‹éƒ¨ç½² App Center ç³»ç»Ÿã€‚

## ç³»ç»Ÿè¦æ±‚

### ç¯å¢ƒè¦æ±‚
- **Node.js**: >= 18.0.0 (æ¨èä½¿ç”¨ nvm å®‰è£…)
- **pnpm**: >= 8.0.0 (æ¨è) æˆ– npm >= 8.0.0
- **æ“ä½œç³»ç»Ÿ**: Linux / macOS / Windows
- **å†…å­˜**: æœ€å°‘ 4GB RAM
- **ç£ç›˜ç©ºé—´**: æœ€å°‘ 50GB å¯ç”¨ç©ºé—´
- **æ•°æ®åº“**: SQLite
- **SSLè¯ä¹¦**: ç”¨äº HTTPS éƒ¨ç½²ï¼ˆiOS IPA å®‰è£…å¿…é¡»ä½¿ç”¨ HTTPSï¼‰

### å¯é€‰ä¾èµ–
- **æ•°æ®åº“**: SQLite (é»˜è®¤) / PostgreSQL / MySQL
- **WebæœåŠ¡å™¨**: Nginx (ç”Ÿäº§ç¯å¢ƒæ¨è)


## 1. ä¸‹è½½ä»£ç 

### ä» GitHub å…‹éš†
```bash
# è¯·å°†ä¸‹é¢çš„URLæ›¿æ¢ä¸ºå®é™…çš„ä»“åº“åœ°å€
git clone https://github.com/your-username/app-center.git
cd app-center
```

**æ³¨æ„**: å¦‚æœæ‚¨æ˜¯ä»å…¶ä»–æºè·å–ä»£ç ï¼Œè¯·ç›¸åº”è°ƒæ•´å…‹éš†å‘½ä»¤ã€‚

## 2. å®‰è£…ä¾èµ–

### æ£€æŸ¥ç¯å¢ƒ
```bash
# è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬
sh shell/check-env.sh
```

**ç¯å¢ƒæ£€æŸ¥è„šæœ¬åŠŸèƒ½ï¼š**
- æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆè¦æ±‚ >= 18.0.0ï¼‰
- è‡ªåŠ¨å®‰è£… pnpmï¼ˆå¦‚æœªå®‰è£…ï¼‰
- éªŒè¯é¡¹ç›®ç»“æ„å®Œæ•´æ€§
- æ£€æŸ¥å¿…è¦çš„é…ç½®æ–‡ä»¶

### å®‰è£…é¡¹ç›®ä¾èµ–
```bash
# è¿è¡Œä¾èµ–å®‰è£…è„šæœ¬
sh shell/install-deps.sh
```

**ä¾èµ–å®‰è£…è„šæœ¬åŠŸèƒ½ï¼š**
- éªŒè¯é¡¹ç›®ç›®å½•ç»“æ„
- å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆæ ¹ç›®å½•ã€å‰ç«¯ã€åç«¯ï¼‰
- æ„å»ºå…±äº«ç±»å‹åŒ…
- éªŒè¯å®‰è£…ç»“æœ

## 3. ç¯å¢ƒé…ç½®

### åç«¯é…ç½®
åç«¯é»˜è®¤é…ç½®æ–‡ä»¶ä½äº `backend/.env`ï¼ŒåŒ…å«ä»¥ä¸‹é…ç½®ï¼š

**âš ï¸ å®‰å…¨æé†’**: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰å¿…é¡»ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç å’Œå¯†é’¥ï¼

**åç«¯ç¯å¢ƒé…ç½®ï¼š**
```bash
# æœåŠ¡å™¨é…ç½®
PORT=8000
NODE_ENV=development

# æ•°æ®åº“é…ç½® (SQLite é»˜è®¤)
DATABASE_PATH=./data/database.sqlite

# JWT å¯†é’¥ (âš ï¸ ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹)
JWT_SECRET=your-super-secret-jwt-key-change-this

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=300MB

# HTTPS é…ç½® (å¯é€‰)
ENABLE_HTTPS=false
SSL_KEY_PATH=../certs/server-key.pem
SSL_CERT_PATH=../certs/server-cert.pem
```

**ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ¸…å•ï¼š**
- âœ… ä¿®æ”¹ `NODE_ENV=production`
- âœ… æ›´æ¢ `JWT_SECRET` ä¸ºéšæœºå¼ºå¯†é’¥
- âœ… é…ç½®SSLè¯ä¹¦ï¼ˆiOSåº”ç”¨åˆ†å‘å¿…éœ€ï¼‰

**é»˜è®¤ç®¡ç†å‘˜è´¦å·è¯´æ˜ï¼š**
- é»˜è®¤è´¦å·é€šè¿‡æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬åˆ›å»º
- è¶…çº§ç®¡ç†å‘˜ï¼š`admin` / `Psw#123456`
- æ™®é€šç®¡ç†å‘˜ï¼š`manager` / `Psw#123456`
- âš ï¸ **éƒ¨ç½²åç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼**

### å‰ç«¯é…ç½®
```bash
# å‰ç«¯é€šå¸¸ä½¿ç”¨é»˜è®¤é…ç½®å³å¯
# å¦‚éœ€è‡ªå®šä¹‰é…ç½®ï¼Œåœ¨ frontend/ ç›®å½•åˆ›å»º .env.local æ–‡ä»¶

# ç¤ºä¾‹è‡ªå®šä¹‰é…ç½® (å¯é€‰)
echo "NEXT_PUBLIC_API_URL=http://localhost:8000" > frontend/.env.local
```

**å‰ç«¯å¯é€‰é…ç½®é¡¹ï¼š**
- `NEXT_PUBLIC_API_URL`: åç«¯APIåœ°å€
- `NEXT_PUBLIC_APP_NAME`: åº”ç”¨åç§°
- `NEXT_PUBLIC_UPLOAD_MAX_SIZE`: ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶

## 4. æ„å»ºé¡¹ç›®

### å¼€å‘ç¯å¢ƒæ„å»º
```bash
# æ„å»ºæ‰€æœ‰æ¨¡å—
pnpm run build
```

### ç”Ÿäº§ç¯å¢ƒæ„å»º
```bash
# è®¾ç½®ç”Ÿäº§ç¯å¢ƒ
export NODE_ENV=production

# æ„å»º
pnpm run build

# éªŒè¯æ„å»ºç»“æœ
ls -la frontend/.next/
ls -la backend/dist/
```

## 5. å¯åŠ¨æœåŠ¡

### å¼€å‘æ¨¡å¼å¯åŠ¨
```bash
# åŒæ—¶å¯åŠ¨å‰åç«¯å¼€å‘æœåŠ¡å™¨
pnpm run dev

# æˆ–åˆ†åˆ«å¯åŠ¨
pnpm run dev:backend    # åç«¯: http://localhost:8000
pnpm run dev:frontend   # å‰ç«¯: http://localhost:3000
```

### ç”Ÿäº§æ¨¡å¼å¯åŠ¨
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
pnpm start

# æˆ–åˆ†åˆ«å¯åŠ¨
pnpm run start:backend   # åç«¯æœåŠ¡
pnpm run start:frontend  # å‰ç«¯æœåŠ¡
```

## 6. é¦–æ¬¡å®‰è£…å‘å¯¼

### è®¿é—®å®‰è£…å‘å¯¼
1. **å¯åŠ¨æœåŠ¡åè®¿é—®**: `http://localhost:3000/install`
2. **æŒ‰ç…§å‘å¯¼æ­¥éª¤å®Œæˆé…ç½®**:

#### æ­¥éª¤1ï¼šè®¸å¯åè®®
- é˜…è¯»å¹¶åŒæ„è½¯ä»¶è®¸å¯åè®®

#### æ­¥éª¤2ï¼šç¯å¢ƒæ£€æµ‹
- è‡ªåŠ¨æ£€æŸ¥ç³»ç»Ÿè¦æ±‚å’Œä¾èµ–
- éªŒè¯Node.jsã€pnpmç‰ˆæœ¬
- æ£€æŸ¥é¡¹ç›®æ–‡ä»¶å®Œæ•´æ€§

#### æ­¥éª¤3ï¼šæ•°æ®åº“åˆå§‹åŒ–
- **è‡ªåŠ¨åˆ›å»º**: ä½¿ç”¨SQLiteæ•°æ®åº“ï¼Œè‡ªåŠ¨åˆå§‹åŒ–è¡¨ç»“æ„å’ŒåŸºç¡€æ•°æ®
- **ç®¡ç†å‘˜è´¦æˆ·**: åœ¨ç•Œé¢ä¸­è®¾ç½®è¶…çº§ç®¡ç†å‘˜ä¿¡æ¯
- **ç³»ç»Ÿé…ç½®**: åŸºç¡€ç³»ç»Ÿå‚æ•°è®¾ç½®

#### æ­¥éª¤4ï¼šç¼“å­˜é…ç½® (å¯é€‰)
- **å†…å­˜ç¼“å­˜**: é»˜è®¤ä½¿ç”¨å†…å­˜ç¼“å­˜
- **Redisé…ç½®**: å¯é€‰é…ç½®Redisä½œä¸ºç¼“å­˜åç«¯

#### æ­¥éª¤5ï¼šç³»ç»Ÿè®¾ç½®
- **ç«™ç‚¹åç§°**: è‡ªå®šä¹‰åº”ç”¨ä¸­å¿ƒåç§°
- **ç³»ç»Ÿé…ç½®**: åŸºç¡€ç³»ç»Ÿå‚æ•°è®¾ç½®
- **å®Œæˆå®‰è£…**: è‡ªåŠ¨è·³è½¬åˆ°ç®¡ç†åå°

### å¿«é€Ÿå®‰è£… (æ¨è)
ä¸€é”®å®Œæˆå®‰è£…ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨ä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š
- **æ•°æ®åº“**: SQLiteæ•°æ®åº“ï¼Œè‡ªåŠ¨åˆ›å»ºå’Œåˆå§‹åŒ–
- **ç®¡ç†å‘˜**: åœ¨å®‰è£…è¿‡ç¨‹ä¸­è®¾ç½®ç®¡ç†å‘˜è´¦æˆ·
- **ç¼“å­˜**: å†…å­˜ç¼“å­˜
- **ç«™ç‚¹åç§°**: App Center

### é«˜çº§åŠŸèƒ½
- **é‡æ–°å®‰è£…**: å¦‚éœ€é‡æ–°é…ç½®ï¼Œå¯è®¿é—® `/install?force=true`
- **å¤‡ä»½æ¢å¤**: å®‰è£…å‰è‡ªåŠ¨å¤‡ä»½ç°æœ‰æ•°æ®åº“
- **é…ç½®éªŒè¯**: æ¯ä¸ªæ­¥éª¤éƒ½æœ‰å®æ—¶éªŒè¯åé¦ˆ

### å®‰è£…APIæ¥å£ (å¼€å‘è€…å‚è€ƒ)
Webå®‰è£…å‘å¯¼é€šè¿‡ä»¥ä¸‹åç«¯APIå®Œæˆæ•°æ®åº“åˆå§‹åŒ–ï¼š

```http
# æ£€æŸ¥å®‰è£…çŠ¶æ€
GET /api/install/status

# ç¯å¢ƒæ£€æµ‹
GET /api/install/check-environment

# éªŒè¯å®‰è£…ç¯å¢ƒ
GET /api/install/validate

# åˆå§‹åŒ–æ•°æ®åº“
POST /api/install/initialize-database
Content-Type: application/json
{
  "adminUsername": "admin",
  "adminEmail": "admin@example.com", 
  "adminPassword": "your-password",
  "siteName": "App Center"
}

# å®Œæˆå®‰è£…
POST /api/install/complete
```

**å®‰å…¨è¯´æ˜**: 
- å®‰è£…APIä»…åœ¨ç³»ç»Ÿæœªåˆå§‹åŒ–æ—¶å¯ç”¨
- å®Œæˆå®‰è£…åï¼Œè¿™äº›æ¥å£å°†è‡ªåŠ¨ç¦ç”¨
- å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨HTTPS

## 7. éªŒè¯å®‰è£…

### æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
curl http://localhost:8000/api/health

# æ£€æŸ¥å‰ç«¯æœåŠ¡
curl http://localhost:3000
```

### ç™»å½•ç®¡ç†åå°
1. è®¿é—®: `http://localhost:3000/dashboard`
2. ä½¿ç”¨å®‰è£…æ—¶åˆ›å»ºçš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•
3. éªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸

## 8. ç”Ÿäº§ç¯å¢ƒé…ç½®

### SSL è¯ä¹¦é…ç½®
```bash
# ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ (å¼€å‘æµ‹è¯•)
cd certs
openssl req -x509 -newkey rsa:4096 -keyout server-key.pem -out server-cert.pem -days 365 -nodes

# æˆ–ä½¿ç”¨ Let's Encrypt (ç”Ÿäº§æ¨è)
certbot certonly --standalone -d yourdomain.com
```



### è¿›ç¨‹ç®¡ç† (PM2)
```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start ecosystem.config.js

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

**ecosystem.config.js ç¤ºä¾‹ï¼š**
```javascript
module.exports = {
  apps: [
    {
      name: 'app-center-backend',
      script: './backend/dist/server.js',
      cwd: './',
      env: {
        NODE_ENV: 'production',
        PORT: 8000
      }
    },
    {
      name: 'app-center-frontend',
      script: 'next',
      args: 'start --port 3000',
      cwd: './frontend',
      env: {
        NODE_ENV: 'production'
      }
    }
  ]
};
```

## 9. å®‰è£…å®Œæˆï¼Œé¦–æ¬¡ç™»å½•

### è®¿é—®ç³»ç»Ÿ
- **ä¸»é¡µ**: `http://localhost:3000`
- **ç®¡ç†åå°**: `http://localhost:3000/dashboard`

### ç®¡ç†å‘˜è´¦æˆ·
- **ç™»å½•ä¿¡æ¯**: ä½¿ç”¨å®‰è£…å‘å¯¼ä¸­è®¾ç½®çš„ç®¡ç†å‘˜è´¦æˆ·
- **å¿«é€Ÿå®‰è£…é»˜è®¤**: admin / Psw#123456 (å¦‚ä½¿ç”¨å¿«é€Ÿå®‰è£…)
- **âš ï¸ é‡è¦**: é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 

### é¦–æ¬¡ç™»å½•åæ“ä½œ
1. **ä¿®æ”¹ç®¡ç†å‘˜å¯†ç **
2. **é…ç½®ç³»ç»Ÿè®¾ç½®**
3. **åˆ›å»ºå…¶ä»–ç”¨æˆ·è´¦æˆ·**
4. **ä¸Šä¼ ç¬¬ä¸€ä¸ªåº”ç”¨è¿›è¡Œæµ‹è¯•**

## å¸¸è§é—®é¢˜æ’é™¤

### ç«¯å£å†²çª
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :3000
netstat -tulpn | grep :8000

# ä¿®æ”¹ç«¯å£é…ç½®
# ç¼–è¾‘ backend/.env ä¸­çš„ PORT
# ç¼–è¾‘ frontend/package.json ä¸­çš„å¯åŠ¨å‘½ä»¤
```

### æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥ SQLite æ–‡ä»¶æƒé™
ls -la backend/data/database.sqlite

# å¦‚æœéœ€è¦é‡æ–°åˆå§‹åŒ–ï¼Œè¯·è®¿é—®å®‰è£…å‘å¯¼
# http://localhost:3000/install?force=true
```

### æƒé™é—®é¢˜
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
chmod -R 755 ./
chown -R $USER:$USER ./
```

### å†…å­˜ä¸è¶³
```bash
# å¢åŠ  Node.js å†…å­˜é™åˆ¶
export NODE_OPTIONS="--max-old-space-size=4096"
```

## å‡çº§æŒ‡å—

### å¤‡ä»½æ•°æ®
```bash
# å¤‡ä»½æ•°æ®åº“
cp backend/data/database.sqlite backend/data/database.backup.$(date +%Y%m%d_%H%M%S).sqlite

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf uploads.backup.$(date +%Y%m%d_%H%M%S).tar.gz backend/uploads/
```

### å‡çº§æ­¥éª¤
```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. å®‰è£…æ–°ä¾èµ–
pnpm install

# 3. æ„å»ºé¡¹ç›®
pnpm run build

# 4. é‡å¯æœåŠ¡
pm2 restart all
```

## æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ `backend/logs/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
2. æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°é”™è¯¯
3. å‚è€ƒ [GitHub Issues](https://github.com/your-username/app-center/issues)
4. è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿ

---

**ğŸ‰ æ­å–œï¼App Center å®‰è£…å®Œæˆï¼**

ç°åœ¨æ‚¨å¯ä»¥å¼€å§‹ä½¿ç”¨ App Center æ¥ç®¡ç†å’Œåˆ†å‘æ‚¨çš„åº”ç”¨ç¨‹åºäº†ã€‚
